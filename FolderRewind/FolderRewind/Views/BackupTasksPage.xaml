<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="FolderRewind.Views.BackupTasksPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:FolderRewind.Models">

    <Grid Padding="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Spacing="4" Margin="0,0,0,24">
            <TextBlock x:Uid="BackupTasksPage_Title" Style="{ThemeResource TitleTextBlockStyle}"/>
            <TextBlock Text="{x:Bind ViewModel.Count, Mode=OneWay, Converter={StaticResource CountToStringConverter}}" 
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
        </StackPanel>

        <!-- 绑定到 Service 的静态列表 -->
        <ListView Grid.Row="1" SelectionMode="None" ItemsSource="{x:Bind ViewModel}">
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="models:BackupTask">
                    <Grid Margin="0,0,0,16" Padding="12" Background="{ThemeResource LayerFillColorDefaultBrush}" CornerRadius="4">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <TextBlock Text="{x:Bind FolderName}" FontWeight="Bold"/>
                                <TextBlock Text="-" Foreground="Gray"/>
                                <TextBlock Text="{x:Bind Status}" Foreground="{ThemeResource SystemControlForegroundAccentBrush}"/>
                            </StackPanel>

                            <!-- 只有未完成时显示取消按钮 -->
                            <Button Grid.Column="1" Padding="6" CornerRadius="16" Visibility="{x:Bind IsCompleted, Converter={StaticResource BoolToVisInvertConverter}}">
                                <FontIcon Glyph="&#xE711;" FontSize="12"/>
                            </Button>
                        </Grid>

                        <ProgressBar Grid.Row="1" Value="{x:Bind Progress, Mode=OneWay}" Maximum="100" Margin="0,8,0,0" Height="4"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- 空状态提示：当没有任务时显示 -->
        <StackPanel Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center" 
                    Visibility="{x:Bind IsEmpty, Mode=OneWay, Converter={StaticResource BoolToVisConverter}}">
            <FontIcon Glyph="&#xE8FB;" FontSize="48" Opacity="0.3"/>
            <TextBlock x:Uid="BackupTasksPage_EmptyState" Margin="0,16,0,0" Opacity="0.6"/>
        </StackPanel>
    </Grid>
</Page>
